var Layout={layoutStyle:"left",body:$("body"),bodyWidth:$("body").width(),boxResult:$("#result_div"),boxes:$(".boxes"),topBoxesCon:$(".top-boxes"),headerHeight:$("#main-header").outerHeight(),noLineNums:$("body").hasClass("no-line-numbers"),resizer:$("#resizer"),resizerWidth:$("#resizer").width(),dragCover:$("#editor-drag-cover"),widthReadout:$("#width-readout"),heightOfEditorHeader:$(".powers").outerHeight(),editorResizers:$(".editor-resizer"),$mainHeader:$(".main-header"),$siteFooter:$(".site-footer"),boxHTML:$("#box-html"),boxCSS:$("#box-css"),windowResizeTimer:0,init:function(){this.pageType=__pageType,this.layoutStyle="right"===$.cookie("__cp_layout")?"right":"left",this._bindToHub(),this.initLayout(),this.setUpEditorResizers(),this.heightSubstract=this._calcHeightSubtract()},setUpCodeEditorHeights:function(){$(".code-wrap").each(function(){var t=$(this),o=t.closest(".box").height()-Layout.heightOfEditorHeader;t.height(o)})},setUpEditorResizers:function(){Layout.editorResizers.draggable({start:function(){Layout.topBoxesCon.addClass("editor-is-resizing"),Layout.origCSSEditorHeight=Layout.boxCSS.height(),Layout.origHTMLEditorHeight=Layout.boxHTML.height()},stop:function(){Layout.topBoxesCon.removeClass("editor-is-resizing"),Layout.setUpCodeEditorHeights(),Hub.pub("editor-refresh",{delay:200})},axis:"y",drag:function(t,o){"editor-resizer-html"===o.helper[0].id?Layout.boxHTML.css("flex","0 1 "+(o.offset.top-Layout.headerHeight)+"px"):Layout.boxCSS.css("flex","0 1 "+(Layout.origCSSEditorHeight+o.position.top)+"px")},containment:Layout.boxes})},_bindToHub:function(){Hub.sub("server-ui-change",$.proxy(this._onUIChange,this))},_onUIChange:function(t,o){if(o.ui&&o.ui.layout&&this.layoutStyle!==o.ui.layout){var e=$("#"+o.ui.layout+"-layout").attr("href");document.location=e}},_calcHeightSubtract:function(){return"pres"===this.pageType?this.$siteFooter.outerHeight()-1:this.$mainHeader.outerHeight()+this.$siteFooter.outerHeight()},initLayout:function(){Layout.resizer.draggable({start:function(){Layout.dragCover.show(),Layout.widthReadout.addClass("visible"),Layout.boxResult.addClass("has-moved")},stop:function(t,o){Layout.stopDragging(t,o),Layout.widthReadout.removeClass("visible")},axis:"x",drag:function(t,o){"right"===Layout.layoutStyle?(Layout.topBoxesCon.width(Layout.bodyWidth-o.offset.left),Layout.widthReadout.text(Math.round(o.offset.left-14)+"px")):(Layout.topBoxesCon.width(o.offset.left),Layout.widthReadout.text(Math.round(Layout.bodyWidth-o.offset.left)-14+"px"))},containment:$(".page-wrap")})},stopDragging:function(){Layout.dragCover.hide(),"function"==typeof Comment.tweakCommentsSize&&Comment.tweakCommentsSize(),Hub.pub("editor-refresh",{delay:0})},doneLoading:function(){Layout.body.removeClass("prelayout"),$(window).load(function(){Layout.body.removeClass("preload")}).resize(function(){Layout.boxes.height(Layout.body.height()-Layout.heightSubstract),Layout.setUpEditorResizers(),clearTimeout(Layout.windowResizeTimer),Layout.topBoxesCon.addClass("editor-is-resizing"),Layout.windowResizeTimer=setTimeout(function(){Layout.setUpCodeEditorHeights(),Layout.topBoxesCon.removeClass("editor-is-resizing"),Layout.bodyWidth=$("body").width()},600)}).resize(),Layout.resizer.trigger("drag"),Layout.setUpCodeEditorHeights()}};Layout.init();